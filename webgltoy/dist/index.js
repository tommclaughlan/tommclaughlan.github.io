!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);const i="\n    uniform vec2 uTranslate;\n\n    vec2 translateVertex(vec2 vertex) {\n        return vertex + uTranslate;\n    }\n    #define TRANSLATE_VERTEX;\n",r="\n    uniform vec2 uScale;\n\n    vec2 scaleVertex(vec2 vertex) {\n        return vertex * uScale;\n    }\n    #define SCALE_VERTEX;\n",o="\n    #ifndef SCALE_VERTEX\n        vec2 scaleVertex(vec2 vertex) {\n            return vertex;\n        }\n    #endif\n\n    #ifndef TRANSLATE_VERTEX\n        vec2 translateVertex(vec2 vertex) {\n            return vertex;\n        }\n    #endif\n\n    uniform vec2 uResolution;\n\n    vec2 toClipSpace(vec2 vertex) {\n        return scaleVertex((2.0 * (translateVertex(vertex) / uResolution)) - 1.0);\n    }\n    #define TO_CLIP_SPACE;\n",s="\n    precision mediump float;\n    attribute vec4 aVertexPosition;\n    attribute vec4 aColor;\n\n    varying float vSize;\n    varying vec4 vColor;\n\n    #ifndef TO_CLIP_SPACE\n        vec2 toClipSpace(vec2 vertex) {\n            return vertex;\n        }\n    #endif\n\n    void main() {\n        vec2 vertex = toClipSpace(vec2(aVertexPosition[0], aVertexPosition[1]));\n        vSize = aVertexPosition[2];\n        gl_Position = vec4(vertex, 0.0, 1.0);\n        gl_PointSize = vSize;\n        vColor = aColor;\n    }\n",a="\n    precision mediump float;\n\n    uniform vec4 uColor;\n\n    varying float vSize;\n    varying vec4 vColor;\n\n    void main() {\n        float distance = length(2.0 * gl_PointCoord - 1.0) * vSize;\n        if (distance > vSize) {\n            discard;\n        } else {\n            gl_FragColor = vColor;\n        }\n    }\n";var l=t=>{const e=t.createBuffer(),n=n=>(t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,n,t.DYNAMIC_DRAW),e);return n.updateData=(n,i)=>(t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferSubData(t.ARRAY_BUFFER,n*Float32Array.BYTES_PER_ELEMENT,i),e),n.loc=()=>e,n};class h{constructor(t,e,n){this.x=t,this.y=e,this.r=n,this.color=[.6,.6,.6,.8]}getPoints(){return[this.x,this.y,this.r]}getColors(){return this.color}setColor(t){this.color=t}move(t,e){this.x+=t,this.y+=e}}const c=document.querySelector("#webgl"),g=new class{constructor(t){this.gl=t.getContext("webgl"),this.program=this.createProgram(),this.positionBuffer=l(this.gl),this.colorBuffer=l(this.gl),this.scale=8,this.translation=[0,0],this.numElements=0,this.vertexLocation=this.gl.getAttribLocation(this.program,"aVertexPosition"),this.colorLocation=this.gl.getAttribLocation(this.program,"aColor"),this.sizeLocation=this.gl.getAttribLocation(this.program,"aSize"),this.resolutionLocation=this.gl.getUniformLocation(this.program,"uResolution"),this.scaleLocation=this.gl.getUniformLocation(this.program,"uScale"),this.translateLocation=this.gl.getUniformLocation(this.program,"uTranslate")}setUp(){this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.useProgram(this.program),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer.loc()),this.gl.vertexAttribPointer(this.vertexLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.vertexLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorBuffer.loc()),this.gl.vertexAttribPointer(this.colorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.colorLocation)}createProgram(){const t=this.loadShader(i+r+o+s,this.gl.VERTEX_SHADER),e=this.loadShader(a,this.gl.FRAGMENT_SHADER),n=this.gl.createProgram();return this.gl.attachShader(n,t),this.gl.attachShader(n,e),this.gl.linkProgram(n),this.gl.getProgramParameter(n,this.gl.LINK_STATUS)?n:(console.log(this.gl.getProgramInfoLog(n)),this.gl.deleteProgram(n),null)}loadShader(t,e){const n=this.gl.createShader(e);return this.gl.shaderSource(n,t),this.gl.compileShader(n),this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS)?n:(console.log(this.gl.getShaderInfoLog(n)),this.gl.deleteShader(n),null)}zoom(t){this.scale+=t,this.scale<=.1&&(this.scale=.1)}translate([t,e]){this.translation=[this.translation[0]+t/this.scale,this.translation[1]+e/this.scale]}resizeCanvas(){const t=this.gl.canvas.clientWidth,e=this.gl.canvas.clientHeight;this.gl.canvas.width===t&&this.gl.canvas.height===e||(this.gl.canvas.width=t,this.gl.canvas.height=e),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}setPoints(t,e){this.positionBuffer(t),this.colorBuffer(e),this.numElements=t.length/3}drawPoints(){this.resizeCanvas(),this.gl.uniform2f(this.resolutionLocation,this.gl.canvas.width,this.gl.canvas.height),this.gl.uniform2fv(this.scaleLocation,[this.scale,this.scale]),this.gl.uniform2fv(this.translateLocation,this.translation),this.gl.drawArrays(this.gl.POINTS,0,this.numElements)}updatePoints(t,e,n,i){this.positionBuffer.updateData(e,t),this.colorBuffer.updateData(i,n)}draw(t){this.resizeCanvas(),this.gl.uniform2f(this.resolutionLocation,this.gl.canvas.width,this.gl.canvas.height),this.gl.drawArrays(this.gl.POINTS,0,t)}}(c);c.addEventListener("wheel",t=>{t.preventDefault(),g.zoom(-t.deltaY/1e3)});let u=!1;c.addEventListener("mousedown",t=>{t.preventDefault(),u=!0}),c.addEventListener("mouseup",t=>{t.preventDefault(),u=!1,f=[]});let f=[];c.addEventListener("mousemove",t=>{if(t.preventDefault(),u){if(f.length>0){let e=[t.offsetX-f[0],f[1]-t.offsetY];g.translate(e)}f=[t.offsetX,t.offsetY]}});const v=[];for(let t=0;t<1e6;t++)v.push(new h(1500*Math.random(),800*Math.random(),5+10*Math.random()));v.forEach((t,e)=>{e%4==0&&t.setColor([Math.random(),Math.random(),Math.random(),.7])}),g.setUp();let d=Date.now(),m=0,p=0,S=new Float32Array(3*v.length),A=new Float32Array(4*v.length),P=0,x=0;v.forEach((t,e)=>{const n=new Float32Array(t.getPoints()),i=new Float32Array(t.getColors());S[P++]=n[0],S[P++]=n[1],S[P++]=n[2],A[x++]=i[0],A[x++]=i[1],A[x++]=i[2],A[x++]=i[3]}),g.setPoints(S,A);const E=()=>{L(),g.drawPoints(),requestAnimationFrame(E)},L=()=>{let t=1e3/(Date.now()-d);d=Date.now(),m+=t,25===++p&&(document.querySelector("#fps").innerHTML=`${(m/p).toFixed(2)} FPS`,p=0,m=0)};requestAnimationFrame(E)}]);
//# sourceMappingURL=index.js.map